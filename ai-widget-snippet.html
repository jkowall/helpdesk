<!-- 
  Paessler Helpdesk AI Widget Snippet
  This snippet includes the top-bar header, the Embrace AI chat widget, and the expand/collapse logic.
-->

<style>
    :root {
        --widget-height-collapsed: 50px;
        --widget-bg: #004b87;
        --widget-text-white: #ffffff;
        --brand-green: #90c226;
        --brand-blue: #00adef;
    }

    #embrace-widget-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: var(--widget-height-collapsed);
        background-color: var(--widget-bg);
        color: var(--widget-text-white);
        z-index: 9999;
        transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 24px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        font-family: 'Open Sans', Roboto, sans-serif;
    }

    #embrace-widget-container.widget-fullscreen {
        height: 100vh;
        width: 100vw;
        padding: 0;
        flex-direction: column;
        align-items: stretch;
        background-color: #fff;
    }

    .widget-controls {
        display: flex;
        gap: 10px;
        align-items: center;
        z-index: 10001;
    }

    #embrace-widget-container.widget-fullscreen .widget-controls {
        position: absolute;
        top: 15px;
        right: 20px;
    }

    .bar-label {
        font-weight: 600;
        font-size: 0.9rem;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .bar-label::before {
        content: 'üí¨';
    }

    .ai-disclosure {
        font-size: 0.7rem;
        opacity: 0.6;
        font-weight: 300;
        margin-left: auto;
        margin-right: 16px;
        white-space: nowrap;
    }

    #embrace-widget-container.widget-fullscreen .ai-disclosure {
        display: none;
    }

    .widget-btn {
        background: rgba(255, 255, 255, 0.15);
        border: none;
        color: white;
        padding: 6px 14px;
        border-radius: 4px;
        font-size: 0.8rem;
        font-weight: 700;
        text-transform: uppercase;
        cursor: pointer;
        transition: all 0.2s;
        font-family: inherit;
    }

    .widget-btn:hover {
        background: rgba(255, 255, 255, 0.25);
    }

    .widget-btn.primary {
        background-color: var(--brand-green);
        color: #fff;
    }

    #btn-open-ticket-widget {
        display: none;
        border: 1px solid var(--brand-blue);
        color: var(--brand-blue);
        background: transparent;
    }

    .chat-wrapper {
        flex: 1;
        width: 100%;
        height: 100%;
        display: none;
        position: relative;
    }

    #embrace-widget-container.widget-fullscreen .chat-wrapper {
        display: block;
        padding-top: 60px;
    }
</style>

<!-- Widget HTML -->
<div id="embrace-widget-container" class="widget-top-bar">
    <div class="bar-label">Get Instant Help</div>
    <div class="ai-disclosure">Powered by AI</div>

    <div class="chat-wrapper">
        <embrace-chat org-id="YOUR_ORG_ID" client-id="YOUR_CLIENT_ID" external-id="paessler-helpdesk-widget">
            <template>
                <div slot="initial-message"
                    style="background: #fff8e1; border: 1px solid #ffe082; border-radius: 8px; padding: 10px 14px; margin: 8px 16px; font-size: 0.85rem; color: #6d5b00; display: flex; align-items: flex-start; gap: 8px;">
                    <span style="font-size: 1.1rem;">‚ö†Ô∏è</span>
                    <span>You are chatting with an AI assistant. Responses may not always be accurate. For complex
                        issues, please <strong>open a support ticket</strong>.</span>
                </div>
            </template>
        </embrace-chat>
    </div>

    <div class="widget-controls">
        <a href="https://helpdesk.paessler.com/en/support/tickets/new" id="btn-open-ticket-widget" class="widget-btn"
            style="text-decoration: none;">Still need help? Open a Ticket</a>
        <button id="btn-expand" class="widget-btn primary">Expand Chat</button>
    </div>
</div>

<!-- Essential Scripts -->
<script type="module" src="https://js.dev.embrace.ai/v1/elements.js"></script>
<script>
    (function () {
        const container = document.getElementById('embrace-widget-container');
        const expandBtn = document.getElementById('btn-expand');
        const ticketBtnSnippet = document.getElementById('btn-open-ticket-widget');
        const barLabel = document.querySelector('.bar-label');

        expandBtn.addEventListener('click', () => {
            const isFullscreen = container.classList.toggle('widget-fullscreen');
            if (isFullscreen) {
                expandBtn.textContent = 'Collapse Chat';
                ticketBtnSnippet.style.display = 'inline-block';
                updateWidgetStyles(true);
            } else {
                expandBtn.textContent = 'Expand Chat';
                ticketBtnSnippet.style.display = 'none';
                updateWidgetStyles(false);
            }
        });

        function updateWidgetStyles(isFullscreen) {
            if (isFullscreen) {
                expandBtn.style.color = '#fff';
                expandBtn.style.background = '#90c226';
                barLabel.style.display = 'none';
            } else {
                expandBtn.style.color = 'white';
                expandBtn.style.background = '#90c226';
                barLabel.style.display = 'flex';
            }
        }
    })();
</script>